import{_ as q,e as x,o as a,c as d,a as e,t as l,d as _,F as C,f as E,r as v,u as F,p as D}from"./index-DDxpmVXJ.js";import{p as c}from"./profileService-sHpkJFtD.js";const R={class:"profile-page"},L={key:0,class:"loading"},M={key:1},$={key:0,type:"success",heading:"Success"},j={key:1,type:"emergency",heading:"Error"},U={key:2},G={class:"profile-section"},O={class:"info-grid"},T={class:"info-item"},V={class:"info-item"},Y={class:"info-item"},H={key:0,class:"info-item"},J={key:1,class:"info-item"},K={key:2,class:"info-item"},Q={class:"profile-section"},W={class:"info-grid"},X={class:"info-item"},Z={class:"info-item"},ee={class:"profile-section"},te={class:"info-grid"},se={class:"info-item full-width"},oe={class:"profile-section"},ne={class:"info-grid"},ie={class:"info-item"},le={class:"info-item"},ae={class:"profile-section"},de={key:0,class:"info-grid"},re={class:"info-item"},ue={class:"info-item"},ve={class:"info-item"},_e={class:"info-item"},me={key:1},fe={class:"profile-actions"},ce={key:3},pe={class:"form-section"},ge={class:"form-grid"},he={class:"form-field"},be={label:"First Name",requirement:"required"},ye=["value"],ke={class:"form-field"},we={label:"Last Name",requirement:"required"},Ne=["value"],De={class:"form-field"},Ae={label:"Phone"},Pe=["value"],ze={class:"form-field"},Ie={label:"ASN"},Se=["value"],Be={class:"form-section"},qe={class:"form-grid"},xe={class:"form-field full-width"},Ce={label:"Street Address"},Ee=["value"],Fe={class:"form-field"},Re={label:"City"},Le=["value"],Me={class:"form-field"},$e={label:"Province"},je=["value"],Ue=["value","label"],Ge={class:"form-field"},Oe={label:"Postal Code"},Te=["value"],Ve={class:"form-actions"},Ye=["disabled"],He={key:4,class:"banking-form"},Je={class:"form-grid"},Ke={class:"form-field"},Qe={label:"Institution Number",requirement:"required",helptext:"3 digits"},We=["value"],Xe={class:"form-field"},Ze={label:"Transit Number",requirement:"required",helptext:"5 digits"},et=["value"],tt={class:"form-field"},st={label:"Account Number",requirement:"required",helptext:"Up to 12 digits"},ot=["value"],nt={class:"consent-check"},it=["checked"],lt={class:"form-actions"},at=["disabled"],dt={key:2},rt={type:"information"},ut={__name:"Profile",setup(vt){const A=F(),w=v(!0),p=v(!1),h=v(!1),b=v(!1),y=v(!1),m=v(""),f=v(""),o=v(null),u=v(null),N=v([]),i=D({first_name:"",last_name:"",phone:"",asn:"",address_street:"",address_city:"",address_province:"",address_postal_code:""}),r=D({institution_number:"",transit_number:"",account_number:"",authorization_signed:!1});x(async()=>{var n;try{const[t,s,g]=await Promise.all([c.getProfile(),c.getBanking(),c.getLookup("provinces")]);if(o.value=t.data,u.value=s.data,N.value=g.data||[],!((n=o.value)!=null&&n.profile_complete)){A.push("/profile/setup");return}o.value&&Object.keys(i).forEach(k=>{o.value[k]!=null&&(i[k]=o.value[k])}),u.value&&(r.institution_number=u.value.institution_number,r.transit_number=u.value.transit_number)}catch(t){console.error("Failed to load profile:",t)}finally{w.value=!1}});function P(n){return n?new Date(n).toLocaleDateString("en-CA",{year:"numeric",month:"long",day:"numeric"}):"N/A"}function z(){const n=o.value;return n.address_street?[n.address_street,n.address_city,n.address_province,n.address_postal_code].filter(Boolean).join(", "):"Not provided"}function I(){p.value=!1,o.value&&Object.keys(i).forEach(n=>{i[n]=o.value[n]||""})}async function S(){var n,t;h.value=!0,m.value="",f.value="";try{const s=await c.updateProfile({...i});o.value=s.data,p.value=!1,m.value="Profile updated successfully."}catch(s){f.value=((t=(n=s.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to update profile."}finally{h.value=!1}}async function B(){var n,t,s;b.value=!0,m.value="",f.value="";try{await c.saveBanking({...r});const g=await c.getBanking();u.value=g.data,y.value=!1,m.value="Direct deposit information saved successfully."}catch(g){f.value=((s=(t=(n=g.response)==null?void 0:n.data)==null?void 0:t.errors)==null?void 0:s.join(", "))||"Failed to save banking information."}finally{b.value=!1}}return(n,t)=>(a(),d("div",R,[t[43]||(t[43]=e("header",{class:"page-header"},[e("h1",null,"My Profile")],-1)),w.value?(a(),d("div",L,[...t[16]||(t[16]=[e("goa-circular-progress",{size:"large"},null,-1),e("p",null,"Loading profile...",-1)])])):o.value?(a(),d("div",M,[m.value?(a(),d("goa-callout",$,[e("p",null,l(m.value),1)])):_("",!0),f.value?(a(),d("goa-callout",j,[e("p",null,l(f.value),1)])):_("",!0),p.value?_("",!0):(a(),d("div",U,[e("section",G,[t[23]||(t[23]=e("h2",null,"Personal Information",-1)),e("div",O,[e("div",T,[t[17]||(t[17]=e("strong",null,"Name",-1)),e("span",null,l(o.value.display_name),1)]),e("div",V,[t[18]||(t[18]=e("strong",null,"Date of Birth",-1)),e("span",null,l(P(o.value.date_of_birth)),1)]),e("div",Y,[t[19]||(t[19]=e("strong",null,"SIN",-1)),e("span",null,l(o.value.sin_masked||"Not provided"),1)]),o.value.asn?(a(),d("div",H,[t[20]||(t[20]=e("strong",null,"ASN",-1)),e("span",null,l(o.value.asn),1)])):_("",!0),o.value.gender?(a(),d("div",J,[t[21]||(t[21]=e("strong",null,"Gender",-1)),e("span",null,l(o.value.gender),1)])):_("",!0),o.value.indigenous_status?(a(),d("div",K,[t[22]||(t[22]=e("strong",null,"Indigenous Status",-1)),e("span",null,l(o.value.indigenous_status),1)])):_("",!0)])]),e("section",Q,[t[26]||(t[26]=e("h2",null,"Contact Information",-1)),e("div",W,[e("div",X,[t[24]||(t[24]=e("strong",null,"Email",-1)),e("span",null,l(o.value.email),1)]),e("div",Z,[t[25]||(t[25]=e("strong",null,"Phone",-1)),e("span",null,l(o.value.phone||"Not provided"),1)])])]),e("section",ee,[t[28]||(t[28]=e("h2",null,"Mailing Address",-1)),e("div",te,[e("div",se,[t[27]||(t[27]=e("strong",null,"Address",-1)),e("span",null,l(z()),1)])])]),e("section",oe,[t[31]||(t[31]=e("h2",null,"Citizenship & Residency",-1)),e("div",ne,[e("div",ie,[t[29]||(t[29]=e("strong",null,"Citizenship",-1)),e("span",null,l(o.value.citizenship_status),1)]),e("div",le,[t[30]||(t[30]=e("strong",null,"Alberta Resident",-1)),e("span",null,l(o.value.residency_status?"Yes":"No"),1)])])]),e("section",ae,[t[37]||(t[37]=e("h2",null,"Direct Deposit",-1)),u.value?(a(),d("div",de,[e("div",re,[t[32]||(t[32]=e("strong",null,"Institution",-1)),e("span",null,l(u.value.institution_number),1)]),e("div",ue,[t[33]||(t[33]=e("strong",null,"Transit",-1)),e("span",null,l(u.value.transit_number),1)]),e("div",ve,[t[34]||(t[34]=e("strong",null,"Account",-1)),e("span",null,l(u.value.account_number_masked),1)]),e("div",_e,[t[35]||(t[35]=e("strong",null,"DD Authorized",-1)),e("span",null,l(u.value.authorization_signed?"Yes":"No"),1)])])):(a(),d("div",me,[t[36]||(t[36]=e("p",{class:"no-data"},"No direct deposit information on file.",-1)),e("goa-button",{type:"secondary",size:"compact",on_click:t[0]||(t[0]=s=>y.value=!0)}," Set Up Direct Deposit ",32)]))]),e("div",fe,[e("goa-button",{type:"secondary",on_click:t[1]||(t[1]=s=>p.value=!0)}," Edit Profile ",32)])])),p.value?(a(),d("div",ce,[e("section",pe,[t[38]||(t[38]=e("h2",null,"Edit Personal Information",-1)),e("div",ge,[e("div",he,[e("goa-form-item",be,[e("goa-input",{name:"first_name",value:i.first_name,on_change:t[2]||(t[2]=s=>i.first_name=s.detail.value),width:"100%"},null,40,ye)])]),e("div",ke,[e("goa-form-item",we,[e("goa-input",{name:"last_name",value:i.last_name,on_change:t[3]||(t[3]=s=>i.last_name=s.detail.value),width:"100%"},null,40,Ne)])]),e("div",De,[e("goa-form-item",Ae,[e("goa-input",{name:"phone",value:i.phone,on_change:t[4]||(t[4]=s=>i.phone=s.detail.value),width:"100%"},null,40,Pe)])]),e("div",ze,[e("goa-form-item",Ie,[e("goa-input",{name:"asn",value:i.asn,on_change:t[5]||(t[5]=s=>i.asn=s.detail.value),width:"100%"},null,40,Se)])])])]),e("section",Be,[t[39]||(t[39]=e("h2",null,"Edit Address",-1)),e("div",qe,[e("div",xe,[e("goa-form-item",Ce,[e("goa-input",{name:"address_street",value:i.address_street,on_change:t[6]||(t[6]=s=>i.address_street=s.detail.value),width:"100%"},null,40,Ee)])]),e("div",Fe,[e("goa-form-item",Re,[e("goa-input",{name:"address_city",value:i.address_city,on_change:t[7]||(t[7]=s=>i.address_city=s.detail.value),width:"100%"},null,40,Le)])]),e("div",Me,[e("goa-form-item",$e,[e("goa-dropdown",{name:"address_province",value:i.address_province,on_change:t[8]||(t[8]=s=>i.address_province=s.detail.value)},[(a(!0),d(C,null,E(N.value,s=>(a(),d("goa-dropdown-item",{key:s.code,value:s.code,label:s.label},null,8,Ue))),128))],40,je)])]),e("div",Ge,[e("goa-form-item",Oe,[e("goa-input",{name:"address_postal_code",value:i.address_postal_code,on_change:t[9]||(t[9]=s=>i.address_postal_code=s.detail.value),width:"100%"},null,40,Te)])])])]),e("div",Ve,[e("goa-button",{type:"secondary",on_click:I},"Cancel",32),e("goa-button",{type:"primary",on_click:S,disabled:h.value},l(h.value?"Saving...":"Save Changes"),41,Ye)])])):_("",!0),y.value?(a(),d("div",He,[t[40]||(t[40]=e("h2",null,"Set Up Direct Deposit",-1)),t[41]||(t[41]=e("goa-callout",{type:"information",heading:"Direct Deposit Authorization"},[e("p",null,"I authorize the Government of Alberta to deposit payments directly to my bank account. I understand this authorization remains in effect until I provide written notice of cancellation.")],-1)),e("div",Je,[e("div",Ke,[e("goa-form-item",Qe,[e("goa-input",{name:"institution_number",value:r.institution_number,on_change:t[10]||(t[10]=s=>r.institution_number=s.detail.value),maxlength:"3",width:"100%"},null,40,We)])]),e("div",Xe,[e("goa-form-item",Ze,[e("goa-input",{name:"transit_number",value:r.transit_number,on_change:t[11]||(t[11]=s=>r.transit_number=s.detail.value),maxlength:"5",width:"100%"},null,40,et)])]),e("div",tt,[e("goa-form-item",st,[e("goa-input",{name:"account_number",value:r.account_number,on_change:t[12]||(t[12]=s=>r.account_number=s.detail.value),maxlength:"12",width:"100%"},null,40,ot)])])]),e("div",nt,[e("goa-checkbox",{name:"dd_consent",checked:r.authorization_signed,on_change:t[13]||(t[13]=s=>r.authorization_signed=s.detail.checked),text:"I agree to the Direct Deposit Authorization above"},null,40,it)]),e("div",lt,[e("goa-button",{type:"secondary",on_click:t[14]||(t[14]=s=>y.value=!1)},"Cancel",32),e("goa-button",{type:"primary",on_click:B,disabled:b.value},l(b.value?"Saving...":"Save Banking Info"),41,at)])])):_("",!0)])):(a(),d("div",dt,[e("goa-callout",rt,[t[42]||(t[42]=e("p",null,"No profile found. Please complete your profile setup.",-1)),e("goa-button",{type:"primary",on_click:t[15]||(t[15]=s=>n.$router.push("/profile/setup"))}," Set Up Profile ",32)])]))]))}},ft=q(ut,[["__scopeId","data-v-b236d3a0"]]);export{ft as default};
//# sourceMappingURL=Profile-D2GUMnTg.js.map
