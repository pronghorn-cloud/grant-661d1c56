{"version":3,"file":"Notifications-ChxHARro.js","sources":["../../src/services/notificationService.js","../../src/views/Notifications.vue"],"sourcesContent":["import api from './api';\n\nexport const notificationsAPI = {\n  getAll: (params = {}) => api.get('/notifications', { params }),\n  getUnreadCount: () => api.get('/notifications/unread-count'),\n  markAsRead: (id) => api.put(`/notifications/${id}/read`),\n  markAllAsRead: () => api.put('/notifications/read-all')\n};\n","<template>\n  <div class=\"notifications-page\">\n    <header class=\"page-header\">\n      <h1>Notifications</h1>\n      <goa-button v-if=\"unreadCount > 0\" type=\"tertiary\" size=\"compact\" @_click=\"markAllRead\">\n        Mark All as Read\n      </goa-button>\n    </header>\n\n    <div v-if=\"loading\" class=\"loading\">\n      <goa-circular-progress size=\"large\"></goa-circular-progress>\n    </div>\n\n    <div v-else-if=\"notifications.length === 0\" class=\"empty-state\">\n      <p>No notifications yet.</p>\n      <p>You'll receive notifications when your application status changes.</p>\n    </div>\n\n    <div v-else class=\"notification-list\">\n      <div\n        v-for=\"notif in notifications\"\n        :key=\"notif.id\"\n        class=\"notification-item\"\n        :class=\"{ unread: !notif.read }\"\n        @click=\"handleClick(notif)\"\n      >\n        <div class=\"notif-icon\" :class=\"getIconClass(notif.type)\">\n          <span>{{ getIcon(notif.type) }}</span>\n        </div>\n        <div class=\"notif-content\">\n          <div class=\"notif-header\">\n            <strong>{{ notif.title }}</strong>\n            <span class=\"notif-time\">{{ formatTime(notif.sent_at) }}</span>\n          </div>\n          <p class=\"notif-message\">{{ notif.message }}</p>\n          <span v-if=\"notif.type_label\" class=\"notif-type\">{{ notif.type_label }}</span>\n        </div>\n        <div v-if=\"!notif.read\" class=\"unread-dot\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { notificationsAPI } from '@/services/notificationService';\n\nconst router = useRouter();\nconst loading = ref(true);\nconst notifications = ref([]);\nconst unreadCount = ref(0);\n\nonMounted(async () => {\n  try {\n    const [notifRes, countRes] = await Promise.all([\n      notificationsAPI.getAll(),\n      notificationsAPI.getUnreadCount()\n    ]);\n    notifications.value = notifRes;\n    unreadCount.value = countRes.count;\n  } catch (err) {\n    console.error('Failed to load notifications:', err);\n  } finally {\n    loading.value = false;\n  }\n});\n\nfunction formatTime(dateStr) {\n  if (!dateStr) return '';\n  const date = new Date(dateStr);\n  const now = new Date();\n  const diffMs = now - date;\n  const diffMin = Math.floor(diffMs / 60000);\n  const diffHr = Math.floor(diffMs / 3600000);\n  const diffDay = Math.floor(diffMs / 86400000);\n\n  if (diffMin < 1) return 'Just now';\n  if (diffMin < 60) return `${diffMin}m ago`;\n  if (diffHr < 24) return `${diffHr}h ago`;\n  if (diffDay < 7) return `${diffDay}d ago`;\n  return date.toLocaleDateString('en-CA', { year: 'numeric', month: 'short', day: 'numeric' });\n}\n\nfunction getIcon(type) {\n  const icons = {\n    submitted: '✓',\n    action_required: '!',\n    decision_available: '★',\n    mi_request: '?',\n    payment_processed: '$',\n    cor_request: '✉',\n    deadline_reminder: '⏰'\n  };\n  return icons[type] || '●';\n}\n\nfunction getIconClass(type) {\n  const classes = {\n    submitted: 'icon-success',\n    action_required: 'icon-warning',\n    decision_available: 'icon-info',\n    mi_request: 'icon-warning',\n    payment_processed: 'icon-success',\n    cor_request: 'icon-info',\n    deadline_reminder: 'icon-warning'\n  };\n  return classes[type] || 'icon-info';\n}\n\nasync function handleClick(notif) {\n  if (!notif.read) {\n    try {\n      await notificationsAPI.markAsRead(notif.id);\n      notif.read = true;\n      unreadCount.value = Math.max(0, unreadCount.value - 1);\n    } catch (err) {\n      console.error('Failed to mark as read:', err);\n    }\n  }\n  if (notif.application_id) {\n    router.push('/dashboard');\n  }\n}\n\nasync function markAllRead() {\n  try {\n    await notificationsAPI.markAllAsRead();\n    notifications.value.forEach(n => n.read = true);\n    unreadCount.value = 0;\n  } catch (err) {\n    console.error('Failed to mark all as read:', err);\n  }\n}\n</script>\n\n<style scoped>\n.notifications-page {\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: var(--goa-space-l);\n}\n\n.page-header h1 {\n  font-size: var(--goa-font-size-7);\n  font-weight: var(--goa-font-weight-bold);\n}\n\n.loading {\n  display: flex;\n  justify-content: center;\n  padding: var(--goa-space-xl);\n}\n\n.empty-state {\n  text-align: center;\n  padding: var(--goa-space-2xl);\n  color: var(--goa-color-text-secondary);\n}\n\n.notification-list {\n  display: flex;\n  flex-direction: column;\n}\n\n.notification-item {\n  display: flex;\n  align-items: flex-start;\n  gap: var(--goa-space-m);\n  padding: var(--goa-space-m);\n  border-bottom: 1px solid var(--goa-color-greyscale-200);\n  cursor: pointer;\n  transition: background-color 0.15s;\n}\n\n.notification-item:hover {\n  background: var(--goa-color-greyscale-100);\n}\n\n.notification-item.unread {\n  background: #f0f6ff;\n}\n\n.notification-item.unread:hover {\n  background: #e3efff;\n}\n\n.notif-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  flex-shrink: 0;\n  font-size: var(--goa-font-size-3);\n}\n\n.icon-success { background: #e6f4ea; color: #137333; }\n.icon-warning { background: #fef7e0; color: #b06000; }\n.icon-info { background: #e8f0fe; color: #1a73e8; }\n\n.notif-content {\n  flex: 1;\n  min-width: 0;\n}\n\n.notif-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: baseline;\n  gap: var(--goa-space-s);\n  margin-bottom: var(--goa-space-2xs);\n}\n\n.notif-time {\n  font-size: var(--goa-font-size-1);\n  color: var(--goa-color-text-secondary);\n  white-space: nowrap;\n}\n\n.notif-message {\n  font-size: var(--goa-font-size-2);\n  color: var(--goa-color-text-secondary);\n  margin-bottom: var(--goa-space-2xs);\n}\n\n.notif-type {\n  font-size: var(--goa-font-size-1);\n  color: var(--goa-color-text-secondary);\n  background: var(--goa-color-greyscale-100);\n  padding: 1px 6px;\n  border-radius: 3px;\n}\n\n.unread-dot {\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: var(--goa-color-interactive-default);\n  flex-shrink: 0;\n  margin-top: 6px;\n}\n</style>\n"],"names":["notificationsAPI","params","api","id","router","useRouter","loading","ref","notifications","unreadCount","onMounted","notifRes","countRes","err","formatTime","dateStr","date","diffMs","diffMin","diffHr","diffDay","getIcon","type","getIconClass","handleClick","notif","markAllRead","n","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_cache","_hoisted_3","_hoisted_4","_hoisted_5","_Fragment","_renderList","_normalizeClass","$event","_toDisplayString","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12"],"mappings":"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"}