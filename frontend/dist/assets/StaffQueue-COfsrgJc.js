import{s as y}from"./staffService-ohwfNNCE.js";import{_ as N,e as Q,o,c as i,a as t,t as s,m as L,F as k,f as C,d as h,r,p as U,g as B,n as S}from"./index-DDxpmVXJ.js";const V={class:"staff-queue"},j={class:"page-header"},E={class:"filters"},T={class:"filter-row"},O=["value"],W=["value"],G=["value"],H=["value","label"],J={key:0,class:"bulk-actions"},K=["value","label"],X={key:0,class:"loading"},Y={key:1},Z={class:"queue-table"},ee={class:"check-col"},te=["checked"],ae=["checked","onChange"],le={class:"ref-cell"},se={class:"scholarship-cell"},ne=["on_click"],oe={key:0},ie={key:0,class:"pagination"},ue=["disabled"],re=["disabled"],de={__name:"StaffQueue",setup(ve){const b=r(!0),c=r([]),A=r(0),d=r(1),_=r(1),w=r([]),u=r([]),p=r("submitted_at"),g=r("ASC"),n=U({search:"",status:"",reviewer_id:""}),D=B(()=>n.search||n.status||n.reviewer_id),$=B(()=>c.value.length>0&&u.value.length===c.value.length);Q(async()=>{try{const l=await y.getMembers();w.value=l}catch{}await v()});async function v(){b.value=!0;try{const l=await y.getQueue({status:n.status||void 0,reviewer_id:n.reviewer_id||void 0,search:n.search||void 0,sort_by:p.value,sort_dir:g.value,page:d.value,limit:25});c.value=l.applications,A.value=l.total,_.value=l.totalPages}catch(l){console.error("Failed to load queue:",l)}finally{b.value=!1}}function q(l){return l?new Date(l).toLocaleDateString("en-CA",{year:"numeric",month:"short",day:"numeric"}):"-"}function I(l){return l>=45?"days-overdue":l>=30?"days-warning":""}function m(l){p.value===l?g.value=g.value==="ASC"?"DESC":"ASC":(p.value=l,g.value="ASC"),v()}function f(l){return p.value!==l?"":g.value==="ASC"?"▲":"▼"}function P(l){const e=u.value.indexOf(l);e>=0?u.value.splice(e,1):u.value.push(l)}function R(){$.value?u.value=[]:u.value=c.value.map(l=>l.id)}async function z(l){const e=l.detail.value;if(e)try{await y.bulkAssign(u.value,e),u.value=[],await v()}catch(a){console.error("Bulk assign failed:",a)}}function F(){n.search="",n.status="",n.reviewer_id="",d.value=1,v()}function x(l){d.value=l,v()}return(l,e)=>(o(),i("div",V,[t("header",j,[e[10]||(e[10]=t("h1",null,"Application Work Queue",-1)),t("p",null,s(A.value)+" applications",1)]),t("div",E,[t("div",T,[t("goa-input",{name:"search",placeholder:"Search ref#, name, email...",value:n.search,on_change:e[0]||(e[0]=a=>{n.search=a.detail.value,v()}),width:"250px"},null,40,O),t("goa-dropdown",{name:"status",value:n.status,on_change:e[1]||(e[1]=a=>{n.status=a.detail.value,v()})},[...e[11]||(e[11]=[L('<goa-dropdown-item value="" label="All Statuses" data-v-1f78e934></goa-dropdown-item><goa-dropdown-item value="Submitted" label="Submitted" data-v-1f78e934></goa-dropdown-item><goa-dropdown-item value="Under Review" label="Under Review" data-v-1f78e934></goa-dropdown-item><goa-dropdown-item value="Missing Info" label="Missing Info" data-v-1f78e934></goa-dropdown-item><goa-dropdown-item value="Approved" label="Approved" data-v-1f78e934></goa-dropdown-item><goa-dropdown-item value="Rejected" label="Rejected" data-v-1f78e934></goa-dropdown-item>',6)])],40,W),t("goa-dropdown",{name:"reviewer",value:n.reviewer_id,on_change:e[2]||(e[2]=a=>{n.reviewer_id=a.detail.value,v()})},[e[12]||(e[12]=t("goa-dropdown-item",{value:"",label:"All Reviewers"},null,-1)),(o(!0),i(k,null,C(w.value,a=>(o(),i("goa-dropdown-item",{key:a.id,value:a.id,label:a.display_name},null,8,H))),128))],40,G),D.value?(o(),i("goa-button",{key:0,type:"tertiary",size:"compact",on_click:F},"Clear",32)):h("",!0)]),u.value.length>0?(o(),i("div",J,[t("span",null,s(u.value.length)+" selected",1),t("goa-dropdown",{name:"bulk-assign",value:"",on_change:z},[e[13]||(e[13]=t("goa-dropdown-item",{value:"",label:"Assign to..."},null,-1)),(o(!0),i(k,null,C(w.value,a=>(o(),i("goa-dropdown-item",{key:a.id,value:a.id,label:a.display_name},null,8,K))),128))],32)])):h("",!0)]),b.value?(o(),i("div",X,[...e[14]||(e[14]=[t("goa-circular-progress",{size:"large"},null,-1)])])):(o(),i("div",Y,[t("table",Z,[t("thead",null,[t("tr",null,[t("th",ee,[t("input",{type:"checkbox",onChange:R,checked:$.value},null,40,te)]),t("th",{class:"sortable",onClick:e[3]||(e[3]=a=>m("reference_number"))},"Ref # "+s(f("reference_number")),1),e[15]||(e[15]=t("th",null,"Applicant",-1)),t("th",{class:"sortable",onClick:e[4]||(e[4]=a=>m("scholarship_name"))},"Scholarship "+s(f("scholarship_name")),1),t("th",{class:"sortable",onClick:e[5]||(e[5]=a=>m("status"))},"Status "+s(f("status")),1),t("th",{class:"sortable",onClick:e[6]||(e[6]=a=>m("submitted_at"))},"Submitted "+s(f("submitted_at")),1),t("th",{class:"sortable",onClick:e[7]||(e[7]=a=>m("days_in_queue"))},"Days "+s(f("days_in_queue")),1),e[16]||(e[16]=t("th",null,"Assigned To",-1)),e[17]||(e[17]=t("th",null,"Actions",-1))])]),t("tbody",null,[(o(!0),i(k,null,C(c.value,a=>(o(),i("tr",{key:a.id,class:S({selected:u.value.includes(a.id)})},[t("td",null,[t("input",{type:"checkbox",checked:u.value.includes(a.id),onChange:M=>P(a.id)},null,40,ae)]),t("td",le,s(a.reference_number),1),t("td",null,s(a.applicant_first_name)+" "+s(a.applicant_last_name),1),t("td",se,s(a.scholarship_name),1),t("td",null,[t("span",{class:S(["status-badge",a.status.toLowerCase().replace(/\s+/g,"-")])},s(a.status),3)]),t("td",null,s(q(a.submitted_at)),1),t("td",{class:S(I(a.days_in_queue))},s(a.days_in_queue||"-"),3),t("td",null,s(a.reviewer_name||"Unassigned"),1),t("td",null,[t("goa-button",{type:"tertiary",size:"compact",on_click:M=>l.$router.push("/staff/review/"+a.id)},"Review",40,ne)])],2))),128)),c.value.length===0?(o(),i("tr",oe,[...e[18]||(e[18]=[t("td",{colspan:"9",class:"empty-row"},"No applications found matching your filters.",-1)])])):h("",!0)])]),_.value>1?(o(),i("div",ie,[t("goa-button",{type:"tertiary",size:"compact",disabled:d.value<=1,on_click:e[8]||(e[8]=a=>x(d.value-1))},"Previous",40,ue),t("span",null,"Page "+s(d.value)+" of "+s(_.value),1),t("goa-button",{type:"tertiary",size:"compact",disabled:d.value>=_.value,on_click:e[9]||(e[9]=a=>x(d.value+1))},"Next",40,re)])):h("",!0)]))]))}},me=N(de,[["__scopeId","data-v-1f78e934"]]);export{me as default};
//# sourceMappingURL=StaffQueue-COfsrgJc.js.map
