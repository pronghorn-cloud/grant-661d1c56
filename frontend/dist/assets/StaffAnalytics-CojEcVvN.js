import{j as F,_ as I,e as N,o,c as n,a as s,t as i,q as r,h as _,n as x,F as p,f as u,r as g,g as v}from"./index-DDxpmVXJ.js";const R={getDashboard:()=>F.get("/analytics/dashboard")},O={class:"analytics-page"},V={key:0,class:"loading"},z={key:1,type:"emergency",heading:"Error"},J={key:2},L={class:"kpi-row"},$={class:"kpi-card"},E={class:"kpi-value"},W={class:"kpi-card kpi-success"},q={class:"kpi-value"},H={class:"kpi-bar"},K={class:"kpi-card kpi-warn"},U={class:"kpi-value"},G={class:"kpi-bar"},Q={class:"kpi-card"},X={class:"kpi-value"},Y={class:"kpi-card kpi-info"},Z={class:"kpi-value"},ss={class:"kpi-bar"},ts={class:"kpi-card"},as={class:"kpi-value"},es={class:"kpi-sub"},ls={class:"charts-grid"},os={class:"chart-section"},ns={class:"donut-wrapper"},is={viewBox:"0 0 200 200",class:"donut-chart"},rs=["stroke","stroke-dasharray","stroke-dashoffset"],ds={x:"100",y:"95","text-anchor":"middle",class:"donut-total"},cs={class:"donut-legend"},ps={class:"legend-name"},us={class:"legend-value"},vs={class:"chart-section"},_s={key:0,class:"trend-chart"},hs={class:"trend-bars"},ks=["title"],ys=["title"],gs=["title"],fs={class:"trend-label"},bs={class:"trend-value"},ms={key:1,class:"no-data"},xs={class:"chart-section"},ws={key:0,class:"h-bar-chart"},As=["title"],Ss={class:"h-bar-track"},Ts={class:"h-bar-value"},Ds={key:1,class:"no-data"},js={class:"chart-section"},Ms={key:0,class:"proc-chart"},Bs={class:"proc-label"},Ps={class:"proc-bar-track"},Cs={class:"proc-value"},Fs={key:1,class:"no-data"},Is={__name:"StaffAnalytics",setup(Ns){const f=g(!0),h=g(null),l=g({statusDistribution:[],kpis:{},monthlyTrends:[],topScholarships:[],processingTimes:[],paymentStats:{}});N(async()=>{var e,a;try{l.value=await R.getDashboard()}catch(t){h.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||t.message||"Failed to load analytics"}finally{f.value=!1}});const b=v(()=>l.value.statusDistribution.reduce((e,a)=>e+a.count,0)),w={Draft:"#9e9e9e",Submitted:"#0070c4","Under Review":"#6f42c1","Missing Info":"#b06000",Approved:"#137333",Rejected:"#c5221f","Pending Payment":"#0d6efd",Paid:"#198754"};function m(e){return w[e]||"#666"}const A=v(()=>{const e=b.value;if(e===0)return[];const a=2*Math.PI*80;let t=0;return l.value.statusDistribution.map(c=>{const y=c.count/e*a,C={color:m(c.status),dashArray:`${y} ${a-y}`,dashOffset:-t};return t+=y,C})}),S=v(()=>Math.max(...l.value.monthlyTrends.map(e=>e.total),1));function k(e){return Math.max(e/S.value*120,e>0?4:0)}function T(e){if(!e)return"";const[a,t]=e.split("-");return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(t)-1]||t}const D=v(()=>Math.max(...l.value.topScholarships.map(e=>e.total),1));function d(e){return e/D.value*100}const j=v(()=>Math.max(...l.value.processingTimes.map(e=>e.count),1));function M(e){return e/j.value*100}function B(e){return e.includes("0-7")?"fast":e.includes("8-14")?"medium":e.includes("15-30")?"slow":"very-slow"}function P(e){return(e||0).toLocaleString("en-CA",{minimumFractionDigits:2,maximumFractionDigits:2})}return(e,a)=>(o(),n("div",O,[a[14]||(a[14]=s("header",{class:"page-header"},[s("h1",null,"Analytics Dashboard"),s("p",null,"Key performance indicators and application insights")],-1)),f.value?(o(),n("div",V,[...a[0]||(a[0]=[s("goa-circular-progress",{size:"large"},null,-1)])])):h.value?(o(),n("goa-callout",z,i(h.value),1)):(o(),n("div",J,[s("div",L,[s("div",$,[a[1]||(a[1]=s("span",{class:"kpi-label"},"Total Applications",-1)),s("span",E,i(l.value.kpis.total_applications),1)]),s("div",W,[a[2]||(a[2]=s("span",{class:"kpi-label"},"Approval Rate",-1)),s("span",q,i(l.value.kpis.approval_rate)+"%",1),s("div",H,[s("div",{class:"kpi-bar-fill",style:r({width:l.value.kpis.approval_rate+"%"})},null,4)])]),s("div",K,[a[3]||(a[3]=s("span",{class:"kpi-label"},"MI Rate",-1)),s("span",U,i(l.value.kpis.mi_rate)+"%",1),s("div",G,[s("div",{class:"kpi-bar-fill warn",style:r({width:l.value.kpis.mi_rate+"%"})},null,4)])]),s("div",Q,[a[5]||(a[5]=s("span",{class:"kpi-label"},"Avg. Turnaround",-1)),s("span",X,[_(i(l.value.kpis.avg_turnaround_days)+" ",1),a[4]||(a[4]=s("small",null,"days",-1))]),s("span",{class:x(["kpi-target",l.value.kpis.avg_turnaround_days<=l.value.kpis.target_turnaround_days?"on-target":"off-target"])}," Target: "+i(l.value.kpis.target_turnaround_days)+" days ",3)]),s("div",Y,[a[6]||(a[6]=s("span",{class:"kpi-label"},"DD Adoption",-1)),s("span",Z,i(l.value.kpis.direct_deposit_rate)+"%",1),s("div",ss,[s("div",{class:"kpi-bar-fill info",style:r({width:l.value.kpis.direct_deposit_rate+"%"})},null,4)])]),s("div",ts,[a[7]||(a[7]=s("span",{class:"kpi-label"},"Total Disbursed",-1)),s("span",as,"$"+i(P(l.value.paymentStats.total_disbursed)),1),s("span",es,i(l.value.paymentStats.paid_batches)+" batches paid",1)])]),s("div",ls,[s("section",os,[a[9]||(a[9]=s("h2",null,"Application Status Distribution",-1)),s("div",ns,[(o(),n("svg",is,[(o(!0),n(p,null,u(A.value,(t,c)=>(o(),n("circle",{key:c,cx:"100",cy:"100",r:"80",fill:"none",stroke:t.color,"stroke-width":"30","stroke-dasharray":t.dashArray,"stroke-dashoffset":t.dashOffset,transform:"rotate(-90 100 100)"},null,8,rs))),128)),s("text",ds,i(b.value),1),a[8]||(a[8]=s("text",{x:"100",y:"115","text-anchor":"middle",class:"donut-label"},"Total",-1))])),s("div",cs,[(o(!0),n(p,null,u(l.value.statusDistribution,t=>(o(),n("div",{key:t.status,class:"legend-item"},[s("span",{class:"legend-dot",style:r({background:m(t.status)})},null,4),s("span",ps,i(t.status),1),s("span",us,i(t.count)+" ("+i(t.percentage)+"%)",1)]))),128))])])]),s("section",vs,[a[10]||(a[10]=s("h2",null,"Application Volume (Monthly)",-1)),l.value.monthlyTrends.length>0?(o(),n("div",_s,[(o(!0),n(p,null,u(l.value.monthlyTrends,t=>(o(),n("div",{key:t.month,class:"trend-bar-group"},[s("div",hs,[s("div",{class:"trend-bar approved",style:r({height:k(t.approved)+"px"}),title:"Approved: "+t.approved},null,12,ks),s("div",{class:"trend-bar rejected",style:r({height:k(t.rejected)+"px"}),title:"Rejected: "+t.rejected},null,12,ys),s("div",{class:"trend-bar total",style:r({height:k(t.total-t.approved-t.rejected)+"px"}),title:"Other: "+(t.total-t.approved-t.rejected)},null,12,gs)]),s("span",fs,i(T(t.month)),1),s("span",bs,i(t.total),1)]))),128))])):(o(),n("p",ms,"No trend data available yet.")),a[11]||(a[11]=s("div",{class:"trend-legend"},[s("span",null,[s("span",{class:"legend-dot",style:{background:"#137333"}}),_(" Approved")]),s("span",null,[s("span",{class:"legend-dot",style:{background:"#c5221f"}}),_(" Rejected")]),s("span",null,[s("span",{class:"legend-dot",style:{background:"#0070c4"}}),_(" Other")])],-1))]),s("section",xs,[a[12]||(a[12]=s("h2",null,"Top Scholarships by Volume",-1)),l.value.topScholarships.length>0?(o(),n("div",ws,[(o(!0),n(p,null,u(l.value.topScholarships,t=>(o(),n("div",{key:t.code,class:"h-bar-row"},[s("span",{class:"h-bar-label",title:t.name},i(t.name),9,As),s("div",Ss,[s("div",{class:"h-bar-fill approved",style:r({width:d(t.approved)+"%"})},null,4),s("div",{class:"h-bar-fill rejected",style:r({width:d(t.rejected)+"%",left:d(t.approved)+"%"})},null,4),s("div",{class:"h-bar-fill other",style:r({width:d(t.total-t.approved-t.rejected)+"%",left:d(t.approved+t.rejected)+"%"})},null,4)]),s("span",Ts,i(t.total),1)]))),128))])):(o(),n("p",Ds,"No scholarship data."))]),s("section",js,[a[13]||(a[13]=s("h2",null,"Processing Time Distribution",-1)),l.value.processingTimes.length>0?(o(),n("div",Ms,[(o(!0),n(p,null,u(l.value.processingTimes,t=>(o(),n("div",{key:t.range,class:"proc-row"},[s("span",Bs,i(t.range),1),s("div",Ps,[s("div",{class:x(["proc-bar-fill",B(t.range)]),style:r({width:M(t.count)+"%"})},null,6)]),s("span",Cs,i(t.count),1)]))),128))])):(o(),n("p",Fs,"No processing time data."))])])]))]))}},Vs=I(Is,[["__scopeId","data-v-7bf7fea3"]]);export{Vs as default};
//# sourceMappingURL=StaffAnalytics-CojEcVvN.js.map
