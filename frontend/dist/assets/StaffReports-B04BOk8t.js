import{s as w}from"./staffService-ohwfNNCE.js";import{_ as S,e as k,o as i,c as d,a as e,m as D,d as m,t as s,F as j,f as x,p as A,r as v,n as I}from"./index-DDxpmVXJ.js";const L={class:"staff-reports"},E={class:"report-filters"},C={class:"filter-row"},U={label:"Start Date"},F=["value"],M={label:"End Date"},N=["value"],V={label:"Status"},B=["value"],P={class:"filter-actions"},O=["disabled"],T={key:0,class:"loading"},z={key:1,type:"emergency",heading:"Report Error"},G={key:2},$={class:"metrics-cards"},q={class:"metric-card"},H={class:"metric-value"},J={class:"metric-card"},K={class:"metric-value success"},Q={class:"metric-card"},W={class:"metric-value danger"},X={class:"metric-card"},Y={class:"metric-value warning"},Z={class:"metric-card"},ee={class:"metric-value"},te={class:"metric-card"},ae={class:"metric-value"},se={class:"metric-card"},oe={class:"metric-value"},le={class:"report-table-wrap"},ne={class:"report-table"},re={class:"ref-cell"},ie={class:"scholarship-cell"},de={class:"record-count"},ue={__name:"StaffReports",setup(ce){const u=v(!1),o=v(null),c=v(null),l=A({start_date:"",end_date:"",status:""});async function g(){var r,t;u.value=!0,c.value=null;try{const a={};l.start_date&&(a.start_date=l.start_date),l.end_date&&(a.end_date=l.end_date),l.status&&(a.status=l.status),o.value=await w.getReport(a)}catch(a){console.error("Failed to generate report:",a),c.value=((t=(r=a.response)==null?void 0:r.data)==null?void 0:t.message)||a.message||"Failed to generate report"}finally{u.value=!1}}k(()=>g());function b(r){return r?new Date(r).toLocaleDateString("en-CA",{year:"numeric",month:"short",day:"numeric"}):"-"}function y(){var h;if(!((h=o.value)!=null&&h.data))return;const r=["Reference","First Name","Last Name","Email","Scholarship","Status","Submitted","Decision","Processing Days","Reviewer"],t=o.value.data.map(n=>{var p;return[n.reference_number,n.first_name,n.last_name,n.applicant_email,n.scholarship_name,n.status,((p=n.submitted_at)==null?void 0:p.substring(0,10))||"",n.decision||"",n.processing_days||"",n.reviewer_name||""]}),a=[r.join(","),...t.map(n=>n.map(p=>`"${(p||"").toString().replace(/"/g,'""')}"`).join(","))].join(`
`),R=new Blob([a],{type:"text/csv"}),f=URL.createObjectURL(R),_=document.createElement("a");_.href=f,_.download=`report-${new Date().toISOString().substring(0,10)}.csv`,_.click(),URL.revokeObjectURL(f)}return(r,t)=>(i(),d("div",L,[t[13]||(t[13]=e("header",{class:"page-header"},[e("h1",null,"Reports"),e("p",null,"Generate and export application processing reports")],-1)),e("div",E,[e("div",C,[e("goa-form-item",U,[e("goa-input",{name:"start_date",type:"date",value:l.start_date,on_change:t[0]||(t[0]=a=>l.start_date=a.detail.value),width:"180px"},null,40,F)]),e("goa-form-item",M,[e("goa-input",{name:"end_date",type:"date",value:l.end_date,on_change:t[1]||(t[1]=a=>l.end_date=a.detail.value),width:"180px"},null,40,N)]),e("goa-form-item",V,[e("goa-dropdown",{name:"status",value:l.status,on_change:t[2]||(t[2]=a=>l.status=a.detail.value)},[...t[3]||(t[3]=[D('<goa-dropdown-item value="" label="All Statuses" data-v-e2f88629></goa-dropdown-item><goa-dropdown-item value="Submitted" label="Submitted" data-v-e2f88629></goa-dropdown-item><goa-dropdown-item value="Under Review" label="Under Review" data-v-e2f88629></goa-dropdown-item><goa-dropdown-item value="Missing Info" label="Missing Info" data-v-e2f88629></goa-dropdown-item><goa-dropdown-item value="Approved" label="Approved" data-v-e2f88629></goa-dropdown-item><goa-dropdown-item value="Rejected" label="Rejected" data-v-e2f88629></goa-dropdown-item><goa-dropdown-item value="Paid" label="Paid" data-v-e2f88629></goa-dropdown-item>',7)])],40,B)])]),e("div",P,[e("goa-button",{type:"primary",on_click:g,disabled:u.value},"Generate Report",40,O),o.value?(i(),d("goa-button",{key:0,type:"secondary",on_click:y},"Export CSV",32)):m("",!0)])]),u.value?(i(),d("div",T,[...t[4]||(t[4]=[e("goa-circular-progress",{size:"large"},null,-1)])])):m("",!0),c.value?(i(),d("goa-callout",z,s(c.value),1)):m("",!0),o.value?(i(),d("div",G,[e("div",$,[e("div",q,[t[5]||(t[5]=e("h3",null,"Total",-1)),e("p",H,s(o.value.metrics.total),1)]),e("div",J,[t[6]||(t[6]=e("h3",null,"Approved",-1)),e("p",K,s(o.value.metrics.approved),1)]),e("div",Q,[t[7]||(t[7]=e("h3",null,"Rejected",-1)),e("p",W,s(o.value.metrics.rejected),1)]),e("div",X,[t[8]||(t[8]=e("h3",null,"Missing Info",-1)),e("p",Y,s(o.value.metrics.missingInfo),1)]),e("div",Z,[t[9]||(t[9]=e("h3",null,"Approval Rate",-1)),e("p",ee,s(o.value.metrics.approvalRate)+"%",1)]),e("div",te,[t[10]||(t[10]=e("h3",null,"MI Rate",-1)),e("p",ae,s(o.value.metrics.miRate)+"%",1)]),e("div",se,[t[11]||(t[11]=e("h3",null,"Avg. Turnaround",-1)),e("p",oe,s(o.value.metrics.avgTurnaround)+" days",1)])]),e("div",le,[e("table",ne,[t[12]||(t[12]=e("thead",null,[e("tr",null,[e("th",null,"Ref #"),e("th",null,"Applicant"),e("th",null,"Email"),e("th",null,"Scholarship"),e("th",null,"Status"),e("th",null,"Submitted"),e("th",null,"Decision"),e("th",null,"Days"),e("th",null,"Reviewer")])],-1)),e("tbody",null,[(i(!0),d(j,null,x(o.value.data,a=>(i(),d("tr",{key:a.id},[e("td",re,s(a.reference_number),1),e("td",null,s(a.first_name)+" "+s(a.last_name),1),e("td",null,s(a.applicant_email),1),e("td",ie,s(a.scholarship_name),1),e("td",null,[e("span",{class:I(["status-badge",a.status.toLowerCase().replace(/\s+/g,"-")])},s(a.status),3)]),e("td",null,s(b(a.submitted_at)),1),e("td",null,s(a.decision||"-"),1),e("td",null,s(a.processing_days||"-"),1),e("td",null,s(a.reviewer_name||"-"),1)]))),128))])])]),e("p",de,s(o.value.data.length)+" records",1)])):m("",!0)]))}},_e=S(ue,[["__scopeId","data-v-e2f88629"]]);export{_e as default};
//# sourceMappingURL=StaffReports-B04BOk8t.js.map
