import{_ as U,k as $,e as M,o as n,c as l,a as t,t as r,b as g,d as p,h as R,F as z,f as B,g as f,u as I,r as h,n as N}from"./index-DDxpmVXJ.js";import{p as T}from"./profileService-sHpkJFtD.js";import{a as b}from"./applicationService-COv8CUWQ.js";const W={class:"dashboard-page"},Y={key:0,class:"loading"},L={key:1},V={class:"page-header"},x={key:0,type:"important",heading:"Complete Your Profile"},E={key:1,class:"staff-dashboard"},j={type:"information",heading:"Staff Dashboard"},q={key:2,class:"applicant-dashboard"},G={class:"dashboard-cards"},H={class:"dash-card"},J={class:"dash-stat"},K={class:"dash-card"},O={class:"dash-stat"},Q={class:"dash-card"},X={class:"dash-stat"},Z={key:0,class:"apps-section"},ss={class:"apps-list"},ts={class:"app-info"},es={class:"app-ref"},as={class:"app-actions"},os=["on_click"],ns=["on_click"],ls={key:1,class:"empty-state"},rs={__name:"Dashboard",setup(is){const k=I(),d=$(),m=h(!0),_=h(null),u=h(!1),i=h([]),w=["scholarship_staff","scholarship_manager","admin","superadmin","finance"],c=f(()=>d&&w.includes(d.role)),C=f(()=>i.value.filter(e=>e.status==="Draft").length),S=f(()=>i.value.filter(e=>e.status==="Submitted"||e.status==="Under Review").length);function A(e){return e?new Date(e).toLocaleDateString("en-CA",{year:"numeric",month:"short",day:"numeric"}):""}function D(e){return["Draft","Submitted","Under Review","Missing Info"].includes(e)}async function F(e){try{await b.withdraw(e);const s=i.value.find(a=>a.id===e);s&&(s.status="Withdrawn")}catch(s){console.error("Failed to withdraw:",s)}}return M(async()=>{try{if(c.value){k.replace("/staff/dashboard");return}const[e,s]=await Promise.all([T.getProfile(),b.getMyApplications().catch(()=>({data:[]}))]),a=(e==null?void 0:e.data)||e;_.value=a,u.value=!!(a!=null&&a.first_name&&(a!=null&&a.last_name)&&(a!=null&&a.date_of_birth)),i.value=(s==null?void 0:s.data)||s||[]}catch{u.value=!1}finally{m.value=!1}}),(e,s)=>{var a,v,y;return n(),l("div",W,[m.value?(n(),l("div",Y,[...s[2]||(s[2]=[t("goa-circular-progress",{size:"large"},null,-1)])])):(n(),l("div",L,[t("header",V,[t("h1",null,r(c.value?"Staff Dashboard":"My Dashboard"),1),t("p",null,"Welcome back, "+r(((a=_.value)==null?void 0:a.display_name)||((v=g(d))==null?void 0:v.displayName)||"User"),1)]),!c.value&&!u.value?(n(),l("goa-callout",x,[s[3]||(s[3]=t("p",null,"You need to complete your profile before you can apply for scholarships.",-1)),t("goa-button",{type:"primary",on_click:s[0]||(s[0]=o=>e.$router.push("/profile/setup"))}," Complete Profile ",32)])):p("",!0),c.value?(n(),l("div",E,[t("goa-callout",j,[s[5]||(s[5]=t("p",null,"Staff dashboard features will be implemented in upcoming use cases (UC-STAFF-01 through UC-STAFF-09).",-1)),t("p",null,[s[4]||(s[4]=R("Your role: ",-1)),t("strong",null,r((y=g(d))==null?void 0:y.role),1)])])])):u.value?(n(),l("div",q,[t("div",G,[t("div",H,[s[6]||(s[6]=t("h3",null,"My Applications",-1)),t("p",J,r(i.value.length),1),s[7]||(s[7]=t("p",{class:"dash-label"},"Total Applications",-1))]),t("div",K,[s[8]||(s[8]=t("h3",null,"Drafts",-1)),t("p",O,r(C.value),1),s[9]||(s[9]=t("p",{class:"dash-label"},"In Progress",-1))]),t("div",Q,[s[10]||(s[10]=t("h3",null,"Submitted",-1)),t("p",X,r(S.value),1),s[11]||(s[11]=t("p",{class:"dash-label"},"Under Review",-1))])]),i.value.length>0?(n(),l("section",Z,[s[12]||(s[12]=t("h2",null,"Recent Applications",-1)),t("div",ss,[(n(!0),l(z,null,B(i.value,o=>(n(),l("div",{key:o.id,class:"app-row"},[t("div",ts,[t("strong",null,r(o.scholarship_name),1),t("span",es,"Ref: "+r(o.reference_number)+" | "+r(A(o.submitted_at||o.created_at)),1)]),t("div",as,[t("span",{class:N(["status-badge",o.status.toLowerCase().replace(/\s+/g,"-")])},r(o.status),3),o.status==="Draft"?(n(),l("goa-button",{key:0,type:"primary",size:"compact",on_click:P=>e.$router.push("/apply/"+o.scholarship_id)}," Continue ",40,os)):p("",!0),D(o.status)?(n(),l("goa-button",{key:1,type:"tertiary",size:"compact",on_click:P=>F(o.id)}," Withdraw ",40,ns)):p("",!0)])]))),128))])])):(n(),l("div",ls,[s[13]||(s[13]=t("p",null,"You haven't submitted any applications yet.",-1)),t("goa-button",{type:"primary",on_click:s[1]||(s[1]=o=>e.$router.push("/scholarships"))}," Browse Scholarships ",32)]))])):p("",!0)]))])}}},ps=U(rs,[["__scopeId","data-v-e62877bc"]]);export{ps as default};
//# sourceMappingURL=Dashboard-Ckmvq77n.js.map
